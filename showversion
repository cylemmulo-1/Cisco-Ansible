
---
- hosts: iosswitches
  gather_facts: false
  connection: local

  tasks:
   - name: show run
     ios_command:
       commands:
         - show run | i hostname
         - show version | B SW Version
     register: config
     
     # this builds a show run in the buffer
   - local_action: copy content={{config.stdout}} dest=/etc/ansible/backups/showrunout.txt
   
     # this appends that buffer to a file for when I have multiple entries. The insertafter portion is important. 
   - name: append 
     lineinfile:
       dest: /etc/ansible/backups/showrunout.txt
       line: "{{config.stdout}}"
       insertafter: EOF
     delegate_to: localhost

